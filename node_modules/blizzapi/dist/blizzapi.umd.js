(function(g,E){typeof exports=="object"&&typeof module<"u"?E(exports,require("axios")):typeof define=="function"&&define.amd?define(["exports","axios"],E):(g=typeof globalThis<"u"?globalThis:g||self,E(g.BlizzAPI={},g.axios))})(this,function(g,E){"use strict";var h=(e=>(e.REGIONS="REGIONS",e.LOCALES="LOCALES",e.DEFAULT_LOCALES="DEFAULT_LOCALES",e.REGION_API_HOSTS="REGION_API_HOSTS",e.SC2_REALMS="SC2_REALMS",e.OAUTH_AUTHORIZE_URIS="OAUTH_AUTHORIZE_URIS",e.OAUTH_TOKEN_URIS="OAUTH_TOKEN_URIS",e.OAUTH_CHECK_TOKEN_URIS="OAUTH_CHECK_TOKEN_URIS",e))(h||{}),m=(e=>(e.us="us",e.eu="eu",e.kr="kr",e.tw="tw",e.cn="cn",e))(m||{}),a=(e=>(e[e.us=1]="us",e[e.eu=2]="eu",e[e.kr=3]="kr",e[e.tw=3]="tw",e[e.cn=5]="cn",e))(a||{}),F=(e=>(e.us="1",e.eu="2",e.kr="3",e.tw="3",e.cn="5",e))(F||{}),R=(e=>(e.en_US="en_US",e.es_MX="es_MX",e.pt_BR="pt_BR",e.en_GB="en_GB",e.es_ES="es_ES",e.fr_FR="fr_FR",e.ru_RU="ru_RU",e.de_DE="de_DE",e.pt_PT="pt_PT",e.it_IT="it_IT",e.ko_KR="ko_KR",e.zh_TW="zh_TW",e.zh_CN="zh_CN",e))(R||{}),k=(e=>(e[e.us=0]="us",e[e.eu=0]="eu",e[e.kr=0]="kr",e[e.tw=0]="tw",e[e.cn=0]="cn",e))(k||{}),f=(e=>(e[e.US=1]="US",e[e.LatAm=2]="LatAm",e[e.Europe=1]="Europe",e[e.Russia=2]="Russia",e[e.Korea=1]="Korea",e[e.Taiwan=2]="Taiwan",e[e.China=1]="China",e))(f||{}),K=(e=>(e.US="1",e.LatAm="2",e.Europe="1",e.Russia="2",e.Korea="1",e.Taiwan="2",e.China="1",e))(K||{}),_=(e=>(e.GET="GET",e.POST="POST",e))(_||{}),v=(e=>(e.us="https://us.battle.net",e.eu="https://eu.battle.net",e.kr="https://apac.battle.net",e.tw="https://apac.battle.net",e.cn="https://www.battlenet.com.cn",e))(v||{}),O=(e=>(e.us="https://us.api.blizzard.com",e.eu="https://eu.api.blizzard.com",e.kr="https://kr.api.blizzard.com",e.tw="https://tw.api.blizzard.com",e.cn="https://gateway.battlenet.com.cn",e))(O||{}),I=(e=>(e.authorize="/oauth/authorize",e.token="/oauth/token",e.checkToken="/oauth/check_token?token=",e))(I||{}),b=(e=>(e.LastModified="last-modified",e))(b||{}),C=(e=>(e[e.NotAuthorized=401]="NotAuthorized",e))(C||{}),y=(e=>(e.InvalidToken="invalid_token",e.AccessTokenInvalid="access_token_invalid",e.AccessTokenExpired="access_token_invalid",e))(y||{});const de=e=>e[0]==="/",ge=e=>e.length>3,he=[de,ge],Re=e=>he.every(t=>t(e)),me=e=>/(?:http[s]?:\/\/)[^\s(["<,>]*\.[^\s[",><]*/gm.test(e),fe=Object.freeze({[a.us]:k.us,[a.eu]:k.eu,[a.kr]:k.kr,[a.cn]:k.cn}),pe=Object.freeze({[a.us]:Object.freeze([R.en_US,R.es_MX,R.pt_BR]),[a.eu]:Object.freeze([R.en_GB,R.es_ES,R.fr_FR,R.ru_RU,R.de_DE,R.pt_PT,R.it_IT]),[a.kr]:Object.freeze([R.ko_KR,R.zh_TW]),[a.cn]:Object.freeze([R.zh_CN])}),Oe=Object.freeze({[a.us]:Object.freeze([m.us]),[a.eu]:Object.freeze([m.eu]),[a.kr]:Object.freeze([m.kr,m.tw]),[a.cn]:Object.freeze([m.cn])}),Ae=Object.freeze({[a.us]:Object.freeze([f.US,f.LatAm]),[a.eu]:Object.freeze([f.Europe,f.Russia]),[a.kr]:Object.freeze([f.Korea,f.Taiwan]),[a.cn]:Object.freeze([f.China])}),ke=Object.freeze({[a.us]:O.us,[a.eu]:O.eu,[a.kr]:[O.kr,O.tw],[a.cn]:O.cn}),w=Object.freeze({[a.us]:v.us,[a.eu]:v.eu,[a.kr]:v.kr,[a.cn]:v.cn}),z=e=>Object.freeze({[a.us]:`${w[a.us]}${e}`,[a.eu]:`${w[a.eu]}${e}`,[a.kr]:`${w[a.kr]}${e}`,[a.cn]:`${w[a.cn]}${e}`}),ve=z(I.authorize),Se=z(I.token),Te=z(I.checkToken),p={[h.REGIONS]:Oe,[h.LOCALES]:pe,[h.DEFAULT_LOCALES]:fe,[h.SC2_REALMS]:Ae,[h.REGION_API_HOSTS]:ke,[h.OAUTH_AUTHORIZE_URIS]:ve,[h.OAUTH_TOKEN_URIS]:Se,[h.OAUTH_CHECK_TOKEN_URIS]:Te},A=p[h.REGIONS],Ee=()=>A,_e=()=>Object.keys(A).map(e=>parseInt(e,10)),Ie=()=>{const e=Object.values(A);return[].concat(...e).map(t=>t.toString())},M=e=>{const t=Object.keys(A),n=e.toString();if(!t.includes(n))throw new RangeError(`${n} is not a valid parameter for getRegionNameById()`);return A[n]},S=e=>{try{return!!M(e)}catch{return!1}},N=e=>{const t=e.toLowerCase(),n=Object.keys(A).filter(s=>A[s].includes(t)),r=Number(n[0])||!1;if(!r)throw new RangeError(`"${e}" is not a valid parameter for getRegionIdByName()`);return r},x=e=>{try{return!!N(e)}catch{return!1}},U=(e,t)=>{const n=typeof e=="string"?e:e.toString();if(!S(n))throw new RangeError(`${n} is not a valid parameter for getConstantByRegionId(${e}, '${t}')`);return p[t][e]},ye=(e,t)=>{if(!x(e))throw new RangeError(`${e} is not a valid parameter for getConstantByRegionName(${e}, '${t}')`);const n=N(e);return p[t][n]},$=(e,t)=>S(e)?U(e,t):ye(e.toString(),t),be=p[h.LOCALES],G=()=>be,D=()=>Object.keys(R).filter(e=>Number.isNaN(Number(e))).map(e=>e.toString()),V=e=>U(e,h.LOCALES),q=e=>/^(?:[a-z]{2}_[a-z]{2})$/gi.test(e),Q=e=>{if(!q(e))throw new RangeError(`${e} is not a valid parameter for validateLocale()`);const t=D().map(r=>r.toLowerCase()),n=e.toLowerCase();return t.includes(n)},we=(e,t)=>{const n=e.toLowerCase(),r=Q(n)||!1,s=t.toString(),u=S(s);if(!r)throw new RangeError(`${e} is not a valid locale parameter for isLocaleValidForRegionId()`);if(!u)throw new RangeError(`${t} is not a valid regionId parameter for isLocaleValidForRegionId()`);return V(t).map(i=>i.toLowerCase()).includes(n)},Le=p[h.DEFAULT_LOCALES],je=p[h.LOCALES],W=e=>{const t=e.toString();if(!S(t))throw new RangeError(`${t} is not a valid parameter for getDefaultLocaleNameForRegionId()`);const n=Le[t];return je[e][n]},Ce=()=>{const e=G(),t=Object.keys(e);return Object.assign({},...t.map(n=>({[n]:W(n)})))},ze=()=>p.SC2_REALMS,X=()=>{const e=Object.values(p.SC2_REALMS);return[].concat(...e).filter((t,n,r)=>n===r.indexOf(t))},Z=e=>U(e,h.SC2_REALMS),P=e=>{const t=e.toString();return/^([1-9]{1})$/gi.test(t)},Ne=e=>{if(!P(e))throw new RangeError(`${e} is not a valid parameter for validateSc2Realm()`);const t=X(),n=typeof e=="number"?e:parseInt(e,10);return t.includes(n)},Ue=(e,t)=>{const n=P(e),r=t.toString(),s=S(r);if(!n)throw new RangeError(`${e} is not a valid sc2Realm parameter for isSc2RealmValidForRegionId()`);if(!s)throw new RangeError(`${t} is not a valid regionId parameter for isSc2RealmValidForRegionId()`);const u=Z(t),i=typeof e=="number"?e:parseInt(e,10);return u.includes(i)},$e=e=>{const t=$(e,h.REGION_API_HOSTS);return typeof e=="string"&&e.toLowerCase()===m.kr?t[0]:typeof e=="string"&&e.toLowerCase()===m.tw?t[1]:t},Pe=e=>$(e,h.OAUTH_CHECK_TOKEN_URIS),Be=e=>$(e,h.OAUTH_TOKEN_URIS);var He=Object.defineProperty,J=Object.getOwnPropertySymbols,Fe=Object.prototype.hasOwnProperty,Ke=Object.prototype.propertyIsEnumerable,Y=(e,t,n)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,T=(e,t)=>{for(var n in t||(t={}))Fe.call(t,n)&&Y(e,n,t[n]);if(J)for(var n of J(t))Ke.call(t,n)&&Y(e,n,t[n]);return e},Me=(e,t,n)=>new Promise((r,s)=>{var u=o=>{try{c(n.next(o))}catch(l){s(l)}},i=o=>{try{c(n.throw(o))}catch(l){s(l)}},c=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);c((n=n.apply(e,t)).next())});const B=e=>Me(void 0,null,function*(){const{uri:t,timeout:n,headers:r,params:s,data:u,auth:i}=e,c=e.method||_.GET;if(!me(t))throw new RangeError(`'${t}' is not a valid parameter for fetchFromUri()`);const o=T(T(T(T({method:c,url:encodeURI(t),timeout:n||1e4},r&&{headers:r}),s&&{params:s}),i&&{auth:i}),u&&{data:u}),l=yield E.request(o),j=l.headers[b.LastModified]?l.headers[b.LastModified]:null;return T(T({},l.data),j&&{lastModified:j})}),ee=e=>{const{region:t,clientId:n,clientSecret:r}=e;if(!n)throw new Error("Cannot get access token because no Battle.net client id was provided");if(!r)throw new Error("Cannot get access token because no Battle.net client secret was provided");const s="grant_type=client_credentials",u={username:n,password:r},i=Be(t);return B({data:s,auth:u,uri:i,method:_.POST})};var xe=(e,t,n)=>new Promise((r,s)=>{var u=o=>{try{c(n.next(o))}catch(l){s(l)}},i=o=>{try{c(n.throw(o))}catch(l){s(l)}},c=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);c((n=n.apply(e,t)).next())});const te=(e,t)=>xe(void 0,null,function*(){try{const n=`${Pe(e)}${t}`;return(yield B({uri:n})).error!==y.InvalidToken}catch{return!1}});var Ge=Object.defineProperty,ne=Object.getOwnPropertySymbols,De=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable,oe=(e,t,n)=>t in e?Ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,L=(e,t)=>{for(var n in t||(t={}))De.call(t,n)&&oe(e,n,t[n]);if(ne)for(var n of ne(t))Ve.call(t,n)&&oe(e,n,t[n]);return e},re=(e,t,n)=>new Promise((r,s)=>{var u=o=>{try{c(n.next(o))}catch(l){s(l)}},i=o=>{try{c(n.throw(o))}catch(l){s(l)}},c=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);c((n=n.apply(e,t)).next())});const ae=(e,t)=>{const{region:n,endpoint:r,options:s}=e,{headers:u,params:i,timeout:c}=s;if(!Re(r))throw new RangeError(`${r} is not a valid endpoint.`);const o=`${$e(n)}${r}`,l={Authorization:`Bearer ${t}`},j=L(L({},u),l);return B(L(L({uri:o,method:_.GET,headers:j},i&&{params:i}),c&&{timeout:c}))},se=e=>re(void 0,null,function*(){const{onAccessTokenRefresh:t}=e.options,n=(yield ee(e)).access_token;return t?.(n),ae(e,n)}),qe=e=>re(void 0,null,function*(){var t;const{region:n,accessToken:r}=e,{validateAccessTokenOnEachQuery:s,refreshExpiredAccessToken:u,onAccessTokenExpired:i}=e.options;if(s&&!(yield te(n,r)))return i?.(),u?se(e):{error:y.AccessTokenInvalid};try{return yield ae(e,r)}catch(c){if(((t=c.response)==null?void 0:t.status)===C.NotAuthorized)return i?.(),u?se(e):Promise.resolve({error:y.AccessTokenExpired});throw c}});class Qe{constructor(t,n){this.clientId=t,this.clientSecret=n}}var H=(e,t,n)=>new Promise((r,s)=>{var u=o=>{try{c(n.next(o))}catch(l){s(l)}},i=o=>{try{c(n.throw(o))}catch(l){s(l)}},c=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);c((n=n.apply(e,t)).next())});class ce extends Qe{constructor(t){super(t.clientId,t.clientSecret),this.getAccessToken=()=>H(this,null,function*(){return(yield this.getAccessTokenObject()).access_token}),this.getAccessTokenObject=()=>this.accessTokenObject?Promise.resolve(this.accessTokenObject):this.setAccessTokenObject(),this.getAccessTokenObjectFromBnet=()=>H(this,null,function*(){return ee({region:this.region,clientId:this.clientId,clientSecret:this.clientSecret})}),this.region=t.region,this.accessTokenObject=t.accessToken?{access_token:t.accessToken}:void 0}setAccessToken(){return this.setAccessTokenObject()}setAccessTokenObject(){return H(this,null,function*(){return this.accessTokenObject=yield this.getAccessTokenObjectFromBnet(),this.accessTokenObject})}}ce.validateAccessToken=(e,t)=>te(e,t);var We=Object.defineProperty,ie=Object.getOwnPropertySymbols,Xe=Object.prototype.hasOwnProperty,Ze=Object.prototype.propertyIsEnumerable,le=(e,t,n)=>t in e?We(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ue=(e,t)=>{for(var n in t||(t={}))Xe.call(t,n)&&le(e,n,t[n]);if(ie)for(var n of ie(t))Ze.call(t,n)&&le(e,n,t[n]);return e},Je=(e,t,n)=>new Promise((r,s)=>{var u=o=>{try{c(n.next(o))}catch(l){s(l)}},i=o=>{try{c(n.throw(o))}catch(l){s(l)}},c=o=>o.done?r(o.value):Promise.resolve(o.value).then(u,i);c((n=n.apply(e,t)).next())});class d extends ce{constructor(t){super({region:t.region,clientId:t.clientId,clientSecret:t.clientSecret,accessToken:t.accessToken}),this.query=(n,r)=>Je(this,null,function*(){return qe({endpoint:n,region:r?.region||this.region,clientId:this.clientId,clientSecret:this.clientSecret,accessToken:yield this.getAccessToken(),options:ue(ue({},this.options),r)})}),this.options={validateAccessTokenOnEachQuery:t.validateAccessTokenOnEachQuery||!1,refreshExpiredAccessToken:t.refreshExpiredAccessToken||!1,onAccessTokenExpired:t.onAccessTokenExpired||void 0,onAccessTokenRefresh:t.onAccessTokenRefresh||void 0}}setRegion(t){this.region=t}}d.getAllRegions=Ee,d.getAllRegionIds=_e,d.getAllRegionNames=Ie,d.getRegionNameById=M,d.validateRegionId=S,d.getRegionIdByName=N,d.validateRegionName=x,d.getAllLocales=G,d.getAllLocaleNames=D,d.getLocalesByRegionId=V,d.checkIfLocaleLooksValid=q,d.validateLocale=Q,d.isLocaleValidForRegionId=we,d.getAllSc2Realms=ze,d.getAllAvailableSc2Realms=X,d.getSc2RealmsByRegionId=Z,d.checkIfSc2RealmLooksValid=P,d.validateSc2Realm=Ne,d.isSc2RealmValidForRegionId=Ue,d.getDefaultLocaleNameForRegionId=W,d.getAllDefaultLocaleNames=Ce,g.ApiHeaders=b,g.BlizzAPI=d,g.ConstantKey=h,g.DefaultLocaleIndex=k,g.ErrorCode=C,g.ErrorResponseMessage=y,g.HttpMethod=_,g.Locale=R,g.OAuthEndpoint=I,g.OAuthHost=v,g.RegionHost=O,g.RegionIdAsStringEnum=F,g.RegionIdEnum=a,g.RegionNameEnum=m,g.Sc2Realm=f,g.Sc2RealmAsString=K});
